# Ecostud.io

## Setup

First of all, you will need **PHP 5.6** or newer, **Node.js**, **NPM** and **Grunt CLI** installed.

After cloning the repo, you need to pull in dependencies:

```shell
composer install
npm install
bower install
```

Then you should run the Grunt task that sets up the show:

```shell
grunt setup
```

This will run tasks that generate CSS, put JS dependencies into the right place, etc. After this step you should have a runnable version of the site.

## Build

To build, you can simply run:

```shell
grunt
```

The site will be ready to deploy in the `dist` directory.

## Deploy

There is Grunt task set up to deploy to the current production location (settings are in `grunt-tasks/options/rsync.js`). For this to work, you need your SSH key added on the destination server.

The deploy task will also run the build task, so you do not have to.

```shell
grunt deploy
```

## Project structure

The server side uses a very simple PHP setup, with **Klein** as a router. Templates are stored in **Mustache** format. There is no database, most information can be directly found in the templates.

The team list on the front page is generated from the data found in `data.php`.

### CSS

**Stylus** is used as a preprocessor, files are stored in the `style` directory. Generated CSS will be stored as `css/main.css`.

There is a Grunt task that you can run to watch for changes in your Stylus files. Whenever you save a Stylus file in your editor, the CSS will be automatically generated. For this to work, you need to run:

```shell
grunt watch
```

If you only want to generate CSS once without watching for changes, you can also use:

```shell
grunt stylus
```

The inclusion order of Stylus files is defined in `stylus/index.styl`.

### Fonts

Fonts are stored in the `fonts` directory. They are generated with FontSquirrel and included in `style/fonts.styl`.

There is an icon font (`fonts/icomoon.*`) that was generated with Icomoon. The `fonts/selection.json` file can be imported to the Icomoon app, icons can be added and new font files saved. Don't forget to add the new `selection.json` to the repo and edit `style/icons.styl` with the new icon definitions (the format is different from the CSS file generated by Icomoon, so you have to transform it).

### Images

Images are stored in the `image` directory.

Android avatars, generated on https://androidify.com in animated GIF format, must be converted into MP4, WebM and JPG formats. Simply place the animated GIFs into `image/android` and run `animgif_convert.sh`.

### Javascript

Script files use the **RequireJS** format. That means you should **NOT** add further `<script>` tags into your templates. `js/main.js` is responsible for starting up the show. `js/require_config.js` houses the RequireJS configuration.

During build, all Javascript files will be built into one single file.

### Templates

Mustache templates are found in the `templates` directory.
